import{r as i,j as e,c as _}from"./index-T_edayIv.js";const O=({topic:m,remainingMs:o,progress:r,isRunning:f,onStart:x,onPause:c,onReset:d})=>{const g=Math.floor(o/1e3),N=Math.floor(g/60),h=g%60,j=Math.floor(o%1e3/10),u=r*360,y=()=>o<=0||o<=5e3?"#ef4444":o<=15e3?"#f59e0b":"#06b6d4",k=()=>o<=0||o<=5e3?"#ef4444":o<=15e3?"#f59e0b":"#10b981",v=y(),a=k();return i.useEffect(()=>{const l=s=>{if(!(s.target instanceof HTMLInputElement||s.target instanceof HTMLTextAreaElement))switch(s.key.toLowerCase()){case" ":s.preventDefault(),f?c():x();break;case"r":s.preventDefault(),d();break}};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[f,x,c,d]),e.jsxs("div",{className:"stopwatch-container",children:[e.jsxs("div",{className:"mobile-pie-view",children:[e.jsx("div",{className:"topic-display-mobile",children:e.jsx("h2",{className:"topic-text-mobile",children:m})}),e.jsxs("svg",{className:"pie-chart",viewBox:"0 0 120 120",children:[e.jsx("defs",{children:e.jsxs("mask",{id:"pieMask",children:[e.jsx("circle",{cx:"60",cy:"60",r:"60",fill:"white"}),e.jsx("path",{d:`
                  M 60 60
                  L 60 5
                  A 55 55 0 ${r>.5?1:0} 1 
                  ${60+55*Math.sin(r*2*Math.PI)} 
                  ${60-55*Math.cos(r*2*Math.PI)}
                  Z
                `,fill:"black"})]})}),e.jsx("circle",{cx:"60",cy:"60",r:"55",fill:"rgba(255, 255, 255, 0.05)"}),e.jsx("circle",{cx:"60",cy:"60",r:"55",fill:a,mask:"url(#pieMask)",className:"pie-segment",style:{filter:o<=5e3?`drop-shadow(0 0 8px ${a})`:"none",transition:"fill 0.3s ease"}}),e.jsxs("text",{x:"60",y:"56",textAnchor:"middle",className:"pie-time",fill:"#fff",style:{fontSize:"18px",fontWeight:"bold"},children:[String(N).padStart(2,"0"),":",String(h).padStart(2,"0")]}),e.jsxs("text",{x:"60",y:"70",textAnchor:"middle",className:"pie-ms",fill:"#fff",style:{fontSize:"12px",opacity:.7},children:[".",String(j).padStart(2,"0")]})]}),e.jsxs("div",{className:"mobile-controls",children:[e.jsx("button",{onClick:f?c:x,className:"mobile-control-btn mobile-main-btn",title:f?"Space to pause":"Space to start",children:f?"⏸":"▶"}),e.jsx("button",{onClick:d,className:"mobile-control-btn mobile-reset-btn",title:"R to reset",children:"↻"})]}),e.jsx("div",{className:"keyboard-hints",children:"Space: Play/Pause • R: Reset"})]}),e.jsxs("div",{className:"desktop-watch-view",children:[e.jsx("div",{className:"topic-display",children:e.jsx("h1",{className:"topic-text",children:m})}),e.jsx("div",{className:"stopwatch",children:e.jsxs("div",{className:"stopwatch-bezel",children:[e.jsxs("svg",{className:"progress-ring",viewBox:"0 0 400 400",children:[e.jsx("circle",{cx:"200",cy:"200",r:"190",fill:"none",stroke:"rgba(255, 255, 255, 0.05)",strokeWidth:"4"}),e.jsx("circle",{cx:"200",cy:"200",r:"190",fill:"none",stroke:v,strokeWidth:"4",strokeDasharray:`${2*Math.PI*190}`,strokeDashoffset:`${2*Math.PI*190*(1-r)}`,strokeLinecap:"round",transform:"rotate(-90 200 200)",style:{transition:o<=0?"none":"stroke 0.3s ease",filter:o<=0?"drop-shadow(0 0 20px rgba(239, 68, 68, 0.8))":"none"}})]}),e.jsxs("div",{className:"stopwatch-face",children:[[...Array(12)].map((l,s)=>{const n=(s*30-90)*(Math.PI/180),w=50+42*Math.cos(n),b=50+42*Math.sin(n);return e.jsx("div",{className:"hour-marker",style:{left:`${w}%`,top:`${b}%`},children:e.jsx("div",{className:"marker-dot"})},s)}),[...Array(60)].map((l,s)=>{if(s%5===0)return null;const n=(s*6-90)*(Math.PI/180),w=50+44*Math.cos(n),b=50+44*Math.sin(n);return e.jsx("div",{className:"minute-marker",style:{left:`${w}%`,top:`${b}%`}},s)}),e.jsx("div",{className:"digital-display",children:e.jsxs("div",{className:"digital-time",style:{color:v},children:[String(N).padStart(2,"0"),":",String(h).padStart(2,"0"),".",e.jsx("span",{className:"milliseconds",children:String(j).padStart(2,"0")})]})}),e.jsx("div",{className:"hand second-hand",style:{transform:`rotate(${u}deg)`,backgroundColor:v,boxShadow:o<=0?`0 0 20px ${v}`:"none"},children:e.jsx("div",{className:"hand-tip",style:{backgroundColor:v}})}),e.jsx("div",{className:"center-dot",style:{backgroundColor:v}})]})]})})]})]})},B=({onFileLoad:m})=>{const o=i.useRef(null),[r,f]=i.useState(!1),[x,c]=i.useState(null),[d,g]=i.useState(!1),N=a=>{const l=a.split(`
`).filter(n=>n.trim()),s=[];for(const n of l){const w=n.split("|");if(w.length!==2)throw new Error(`Invalid format on line: "${n}". Expected format: "Topic Name|Duration"`);const b=w[0].trim(),S=parseInt(w[1].trim(),10);if(!b)throw new Error(`Empty topic name on line: "${n}"`);if(isNaN(S)||S<=0)throw new Error(`Invalid duration on line: "${n}". Duration must be a positive number.`);s.push({name:b,duration:S})}if(s.length===0)throw new Error("No topics found in file");return s},h=a=>{if(c(null),!a.name.endsWith(".txt")){c("Please upload a .txt file");return}const l=new FileReader;l.onload=s=>{try{const n=s.target?.result,w=N(n);m(w,d)}catch(n){c(n instanceof Error?n.message:"Failed to parse file")}},l.readAsText(a)},j=a=>{a.preventDefault(),f(!1);const l=a.dataTransfer.files[0];l&&h(l)},u=a=>{a.preventDefault(),f(!0)},y=()=>{f(!1)},k=()=>{o.current?.click()},v=a=>{const l=a.target.files?.[0];l&&h(l)};return e.jsxs("div",{className:"file-upload-container",children:[e.jsxs("div",{className:"branding",children:[e.jsx("h1",{className:"app-title",children:"MarkWatch"}),e.jsx("p",{className:"app-subtitle",children:"Presentation Timer"})]}),e.jsxs("div",{className:`upload-area ${r?"dragging":""}`,onDrop:j,onDragOver:u,onDragLeave:y,onClick:k,children:[e.jsx("input",{ref:o,type:"file",accept:".txt",onChange:v,style:{display:"none"}}),e.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"upload-icon",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),e.jsx("h2",{className:"upload-title",children:"Drop your topics file here"}),e.jsx("p",{className:"upload-description",children:"or click to browse"}),e.jsx("div",{className:"upload-hint",children:"Supports .txt files"})]}),e.jsxs("div",{className:"presenter-mode-option",children:[e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:d,onChange:a=>g(a.target.checked)}),e.jsx("span",{children:"Show Presenter View"})]}),e.jsx("p",{className:"option-hint",children:"Opens a separate window with just the timer display"})]}),x&&e.jsxs("div",{className:"error-message",children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),x]}),e.jsxs("div",{className:"format-guide",children:[e.jsx("h3",{className:"guide-title",children:"File Format"}),e.jsx("div",{className:"guide-content",children:e.jsxs("code",{className:"format-example",children:["Topic Name|Duration in Seconds",e.jsx("br",{}),"Introduction|90",e.jsx("br",{}),"Problem Statement|120",e.jsx("br",{}),"Solution Overview|90"]})})]})]})},L="markwatch_topics",P="markwatch_current_index";function H(){const[m,o]=i.useState(()=>{const t=localStorage.getItem(L);return t?JSON.parse(t):[]}),[r,f]=i.useState(()=>{const t=localStorage.getItem(P);return t?parseInt(t,10):0}),[x,c]=i.useState(!1),[d,g]=i.useState(0),N=i.useRef(0),h=i.useRef(null),j=m[r],u=j?.duration||90;i.useEffect(()=>{m.length>0&&localStorage.setItem(L,JSON.stringify(m))},[m]),i.useEffect(()=>{localStorage.setItem(P,r.toString())},[r]),i.useEffect(()=>{const t=p=>{x&&(p.preventDefault(),p.returnValue="")};return window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t)},[x]),i.useEffect(()=>{const t=p=>{if(!(p.target instanceof HTMLInputElement||p.target instanceof HTMLTextAreaElement))switch(p.key){case"ArrowLeft":p.preventDefault(),w();break;case"ArrowRight":p.preventDefault(),n();break}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[r,m.length]),i.useEffect(()=>{if(!x)return;N.current=performance.now()-d;const t=()=>{const D=performance.now()-N.current;D<u*1e3?g(D):(c(!1),g(u*1e3))},p=setInterval(t,16);let E;const I=()=>{t(),E=requestAnimationFrame(I)};return E=requestAnimationFrame(I),()=>{clearInterval(p),E&&cancelAnimationFrame(E)}},[x,u,d]),i.useEffect(()=>{if(h.current&&!h.current.closed){const t=Math.max(0,u*1e3-d),p=u>0?d/(u*1e3):0;h.current.postMessage({type:"TIMER_UPDATE",payload:{topic:j?.name||"Loading...",remainingMs:t,progress:p,totalDuration:u}},"*")}},[j,d,u]);const y=(t,p)=>{o(t),f(0),g(0),c(!1),p&&t.length>0&&requestAnimationFrame(()=>{k(t[0])})},k=t=>{const I=window.screen.width-800-100,M=window.open("/presenter.html","MarkWatch Presenter",`width=800,height=800,left=${I},top=100,resizable=yes,scrollbars=no`);if(M){h.current=M;const A=T=>{if(T.data.type==="PRESENTER_READY"){const $=t?t.name:j?.name||"Loading...",C=t?t.duration:j?.duration||90,F=Math.max(0,C*1e3-d),W=C>0?d/(C*1e3):0;M.postMessage({type:"TIMER_UPDATE",payload:{topic:$,remainingMs:F,progress:W,totalDuration:C}},"*"),window.removeEventListener("message",A)}};window.addEventListener("message",A);const R=setInterval(()=>{M.closed&&(clearInterval(R),h.current=null)},1e3)}},v=()=>{x&&!window.confirm("Timer is running! Are you sure you want to clear all topics?")||(h.current&&!h.current.closed&&(h.current.close(),h.current=null),o([]),f(0),g(0),c(!1),localStorage.removeItem(L),localStorage.removeItem(P))},a=()=>{j&&c(!0)},l=()=>{c(!1)},s=()=>{c(!1),g(0)},n=()=>{if(r<m.length-1){const t=r+1;f(t),g(0),c(!0)}},w=()=>{if(r>0){const t=r-1;f(t),g(0),c(!0)}},b=Math.max(0,u*1e3-d),S=u>0?d/(u*1e3):0;return e.jsx("div",{className:"app",children:m.length===0?e.jsx(B,{onFileLoad:y}):e.jsxs(e.Fragment,{children:[e.jsx(O,{topic:j.name,remainingMs:b,progress:S,isRunning:x,onStart:a,onPause:l,onReset:s}),e.jsxs("div",{className:"main-controls",children:[e.jsx("button",{onClick:w,disabled:r===0,className:"control-btn nav-btn",title:"Previous (← Arrow Left)",children:"←"}),x?e.jsx("button",{onClick:l,className:"control-btn pause-btn",title:"Pause (Space)",children:"⏸"}):e.jsx("button",{onClick:a,className:"control-btn start-btn",title:"Start (Space)",children:"▶"}),e.jsx("button",{onClick:s,className:"control-btn reset-btn",title:"Reset (R)",children:"↻"}),e.jsx("button",{onClick:n,disabled:r===m.length-1,className:"control-btn nav-btn",title:"Next (→ Arrow Right)",children:"→"}),e.jsx("button",{onClick:v,className:"control-btn clear-btn",title:"Clear all topics",children:"✕"})]}),e.jsx("div",{className:"status-bar",children:e.jsxs("span",{className:"topic-counter",children:[r+1," / ",m.length]})})]})})}_.createRoot(document.getElementById("root")).render(e.jsx(i.StrictMode,{children:e.jsx(H,{})}));
